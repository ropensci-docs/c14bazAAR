<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="c14bazAAR">
<title>Simple plotting options for radiocarbon dates in c14_date_lists • c14bazAAR</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simple plotting options for radiocarbon dates in c14_date_lists">
<meta property="og:description" content="c14bazAAR">
<meta property="og:image" content="https://docs.ropensci.org/c14bazAAR/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">c14bazAAR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">4.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/simple_plotting.html">Simple plotting options for radiocarbon dates in c14_date_lists</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/c14bazAAR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Simple plotting options for radiocarbon dates in c14_date_lists</h1>
                        <h4 data-toc-skip class="author">Clemens Schmid</h4>
            
            <h4 data-toc-skip class="date">2024-03-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/c14bazAAR/blob/HEAD/vignettes/simple_plotting.Rmd" class="external-link"><code>vignettes/simple_plotting.Rmd</code></a></small>
      <div class="d-none name"><code>simple_plotting.Rmd</code></div>
    </div>

    
    
<p>This vignette shows some basic workflows to plot radiocarbon dates in <code>c14_date_list</code>s. This is only a short compilation to get you started.</p>
<p>So let’s begin by loading the main packages for this endeavour: c14bazAAR and <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link">ggplot2</a>. And of course <a href="https://CRAN.R-project.org/package=magrittr" class="external-link">magrittr</a> to enable the pipe (<code>%&gt;%</code>) operator. We will use functions from other packages as well, but address them individually with the <code>::</code> operator.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/c14bazAAR">c14bazAAR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></code></pre></div>
<p>The basis for this example code is the <a href="https://github.com/dirkseidensticker/aDRAC" class="external-link">adrac data collection</a> by Dirk Seidensticker. So let’s download the data with the relevant c14bazAAR getter function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adrac</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/db_getter.html">get_c14data</a></span><span class="op">(</span><span class="st">"adrac"</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="temporal-plotting-of-radiocarbon-ages">Temporal plotting of radiocarbon ages<a class="anchor" aria-label="anchor" href="#temporal-plotting-of-radiocarbon-ages"></a>
</h2>
<p>Radiocarbon dating is a method to determine the absolute age of samples. Therefore one of the main aims for plotting naturally is to display temporal information. Let’s select the dates of one individual site – <em>Batalimo</em> in Central Africa – as a subset to reproduce two of the most common types of radiocarbon date plots.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Batalimo</span> <span class="op">&lt;-</span> <span class="va">adrac</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">site</span> <span class="op">==</span> <span class="st">"Batalimo"</span><span class="op">)</span></span></code></pre></div>
<p>If age modelling and date plotting on a local or regional scale is the major aim of your analysis, you might want to take a look at the <a href="https://CRAN.R-project.org/package=oxcAAR" class="external-link">oxcAAR</a> package. It serves as an R interface to <a href="https://c14.arch.ox.ac.uk/oxcal.html" class="external-link">OxCal</a> and provides powerful default plotting methods</p>
<div class="section level3">
<h3 id="ridgeplots-of-density-distributions">Ridgeplots of density distributions<a class="anchor" aria-label="anchor" href="#ridgeplots-of-density-distributions"></a>
</h3>
<p>One way to plot radiocarbon ages is to show the probability density distribution of individual calibrated dates as ridgeplots. To produce a plot like that, we first of all need the age-probability information for each date. We can calculate that with the function <code><a href="../reference/calibrate.html">c14bazAAR::calibrate()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Batalimo_calibrated</span> <span class="op">&lt;-</span> <span class="va">Batalimo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/calibrate.html">calibrate</a></span><span class="op">(</span>choices <span class="op">=</span> <span class="st">"calprobdistr"</span><span class="op">)</span></span></code></pre></div>
<p>This adds a list column <code>calprobdistr</code> to the input <code>c14_date_list</code>. The list column contains a nested data.frame for each date with its probability distribution.</p>
<pre><code><span><span class="co">##  Radiocarbon date list</span></span>
<span><span class="co">##  dates: 7</span></span>
<span><span class="co">##  sites: 1</span></span>
<span><span class="co">##  countries: 1</span></span>
<span><span class="co">##  uncalBP: 2000 ― 200 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #949494;"># A data frame: 7 × 17</span></span></span>
<span><span class="co">##   sourcedb sourcedb_version method labnr c14age c14std calprobdistr c13val site </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> adrac    2024-03-16       <span style="color: #BB0000;">NA</span>     Bdy-…   <span style="text-decoration: underline;">1</span>890    130 <span style="color: #949494;">&lt;df&gt;</span>             <span style="color: #BB0000;">NA</span> Bata…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> adrac    2024-03-16       <span style="color: #BB0000;">NA</span>     Bdy-…   <span style="text-decoration: underline;">1</span>730    120 <span style="color: #949494;">&lt;df&gt;</span>             <span style="color: #BB0000;">NA</span> Bata…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> adrac    2024-03-16       <span style="color: #BB0000;">NA</span>     Bdy-…   <span style="text-decoration: underline;">1</span>990    210 <span style="color: #949494;">&lt;df&gt;</span>             <span style="color: #BB0000;">NA</span> Bata…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> adrac    2024-03-16       <span style="color: #BB0000;">NA</span>     Bdy-…    240     75 <span style="color: #949494;">&lt;df&gt;</span>             <span style="color: #BB0000;">NA</span> Bata…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> adrac    2024-03-16       <span style="color: #BB0000;">NA</span>     Bdy-…   <span style="text-decoration: underline;">1</span>270    125 <span style="color: #949494;">&lt;df&gt;</span>             <span style="color: #BB0000;">NA</span> Bata…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> adrac    2024-03-16       <span style="color: #BB0000;">NA</span>     Bdy-…   <span style="text-decoration: underline;">1</span>798    101 <span style="color: #949494;">&lt;df&gt;</span>             <span style="color: #BB0000;">NA</span> Bata…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span> adrac    2024-03-16       <span style="color: #BB0000;">NA</span>     Gif-…   <span style="text-decoration: underline;">1</span>590     90 <span style="color: #949494;">&lt;df&gt;</span>             <span style="color: #BB0000;">NA</span> Bata…</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 8 more variables: feature &lt;chr&gt;, period &lt;chr&gt;, material &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   country &lt;chr&gt;, lat &lt;dbl&gt;, lon &lt;dbl&gt;, shortref &lt;chr&gt;, comment &lt;chr&gt;</span></span></span></code></pre>
<p>With <code><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">tidyr::unnest()</a></code> the list column can be dissolved (“unnested”) and integrated into the initial <code>c14_date_list</code>. Of course the latter looses its original structure and meaning with this step. Each row now represents the probability for one date and year.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Batalimo_cal_dens</span> <span class="op">&lt;-</span> <span class="va">Batalimo_calibrated</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"calprobdistr"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>A table like that can be used for plotting a ridgeplot.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Batalimo_cal_dens</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># a special geom for ridgeplots is provided by the ggridges package</span></span>
<span>  <span class="fu">ggridges</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/ggridges/reference/geom_ridgeline.html" class="external-link">geom_ridgeline</a></span><span class="op">(</span></span>
<span>    <span class="co"># the relevant variables that have to be mapped for this geom are </span></span>
<span>    <span class="co"># x (the time -- here the calibrated age transformed to calBC), </span></span>
<span>    <span class="co"># y (the individual lab number of the dates) and</span></span>
<span>    <span class="co"># height (the probability for each year and date) </span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="va">calage</span> <span class="op">+</span> <span class="fl">1950</span>, y <span class="op">=</span> <span class="va">labnr</span>, height <span class="op">=</span> <span class="va">density</span><span class="op">)</span>,</span>
<span>    <span class="co"># ridgeplots lack a scientifically clear y axis for each </span></span>
<span>    <span class="co"># distribution plot and we can adjust the scaling to our needs</span></span>
<span>    scale <span class="op">=</span> <span class="fl">300</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"age calBC/calAD"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"dates"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simple_plotting_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="calcurve-plot">Calcurve plot<a class="anchor" aria-label="anchor" href="#calcurve-plot"></a>
</h3>
<p>Another way to plot radiocarbon dates is to project them onto a calibration curve. The <a href="https://CRAN.R-project.org/package=Bchron" class="external-link">Bchron</a> R package contains a data.frame with the <a href="https://www.doi.org/10.2458/azu_js_rc.55.16947" class="external-link">intcal13</a> calibration curve data. We can load the <code>intcal13</code> table directly from Bchron.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'data/intcal13.rda'</span>, package <span class="op">=</span> <span class="st">'Bchron'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>For this kind of plot it is more convenient to work with the simplified <code>calrange</code> output of <code><a href="../reference/calibrate.html">c14bazAAR::calibrate()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Batalimo_calibrated</span> <span class="op">&lt;-</span> <span class="va">Batalimo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/calibrate.html">calibrate</a></span><span class="op">(</span>choices <span class="op">=</span> <span class="st">"calrange"</span><span class="op">)</span></span></code></pre></div>
<p>Like the <code>calprobdistr</code> option this also adds a list column to the input <code>c14_date_list</code>, but a much smaller one. For each date only the age ranges that make up the 2-sigma significance interval of the probability distribution are stored.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Batalimo_calibrated</span><span class="op">$</span><span class="va">calrange</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">##   dens from   to</span></span>
<span><span class="co">## 1 91.9 1521 2148</span></span>
<span><span class="co">## 2  3.3 2275 2287</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##   dens from   to</span></span>
<span><span class="co">## 1 93.7 1363 1889</span></span>
<span><span class="co">## 2  1.5 1913 1917</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[3]]</span></span>
<span><span class="co">##   dens from   to</span></span>
<span><span class="co">## 1 94.1 1407 2430</span></span>
<span><span class="co">## 2  1.2 2453 2460</span></span></code></pre>
<p>The resulting table can also be unnested to make the list column content available in the main table.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Batalimo_cal_range</span> <span class="op">&lt;-</span> <span class="va">Batalimo_calibrated</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"calrange"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now we can plot the calibration curve and – on top – error bars with the <code>calrange</code> sequences.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># line plot of the intcal curve</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">intcal13</span>,</span>
<span>    <span class="co"># again we transform the age information from BP to BC</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="va">V1</span> <span class="op">+</span> <span class="fl">1950</span>, y <span class="op">=</span> <span class="op">-</span><span class="va">V2</span> <span class="op">+</span> <span class="fl">1950</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># the errorbars are plotted on top of the curve</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_errorbarh.html" class="external-link">geom_errorbarh</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">Batalimo_cal_range</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="op">-</span><span class="va">c14age</span> <span class="op">+</span> <span class="fl">1950</span>, xmin <span class="op">=</span> <span class="op">-</span><span class="va">to</span> <span class="op">+</span> <span class="fl">1950</span>, xmax <span class="op">=</span> <span class="op">-</span><span class="va">from</span> <span class="op">+</span> <span class="fl">1950</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># we define the age range manually -- typically the calcurve</span></span>
<span>  <span class="co"># is arranged to go from the top left to the bottom right corner</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span>, <span class="fl">2000</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="op">-</span><span class="fl">1000</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"age calBC/calAD"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"uncalibrated age BC/AD"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simple_plotting_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="spatial-mapping-of-radiocarbon-dates">Spatial mapping of radiocarbon dates<a class="anchor" aria-label="anchor" href="#spatial-mapping-of-radiocarbon-dates"></a>
</h2>
<p>Most radiocarbon dates that can be accessed with c14bazAAR have coordinate information for the respective sites where the samples were taken. Spatial maps therefore are an important form of data visualization as well.</p>
<p><code>c14_date_list</code>s can directly be transformed to objects of class <code>sf</code>. <code>sf</code> objects were introduced by the R package <a href="https://CRAN.R-project.org/package=sf" class="external-link">sf</a> which provides a tidy interface to work with spatial data in R.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adrac_sf</span> <span class="op">&lt;-</span> <span class="va">adrac</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/as.sf.html">as.sf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in remove_dates_without_coordinates(., quiet): Dates without</span></span>
<span><span class="co">## coordinates were removed.</span></span></code></pre>
<p>This tabular data structure contains the spatial point information for each date in a column <em>geom</em>, but also the initial columns of the input dataset: <em>data.*</em></p>
<pre><code><span><span class="co">## Simple feature collection with 2178 features and 3 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 8.717 ymin: -16.75 xmax: 30.683 ymax: 12.2</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">## First 10 features:</span></span>
<span><span class="co">##    data.labnr data.c14age data.c14std                 geom</span></span>
<span><span class="co">## 1    AA-33171       13800         100 POINT (10.078 1.727)</span></span>
<span><span class="co">## 2    AA-33172        6665          90 POINT (10.078 1.727)</span></span>
<span><span class="co">## 3    AA-33225       10015          55    POINT (28.6 2.17)</span></span>
<span><span class="co">## 4    AA-33226        6025          70    POINT (28.6 2.17)</span></span>
<span><span class="co">## 5    AA-36757        4254          49 POINT (10.078 1.727)</span></span>
<span><span class="co">## 6    AA-36758       10450          93 POINT (10.078 1.727)</span></span>
<span><span class="co">## 7    AA-36792        5810         290 POINT (10.078 1.727)</span></span>
<span><span class="co">## 8    AA-36793       30300        1300 POINT (10.078 1.727)</span></span>
<span><span class="co">## 9    AA-78447        2362          39 POINT (16.924 3.989)</span></span>
<span><span class="co">## 10   AA-78448        2171          37 POINT (16.924 3.989)</span></span></code></pre>
<p>It can be manipulated with the powerful dplyr functions. We <code>filter</code> out all dates from one particular publication (<em>Moga 2008</em>), <code>group</code> the dates <code>by</code> <em>site</em> and apply the <code>summarise</code> command to keep only one value per group. As we do not define an operation to fold the other variables in the input table, they are removed. Only the geometry column remains.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Moga_spatial</span> <span class="op">&lt;-</span> <span class="va">adrac_sf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Moga 2008"</span>, <span class="va">data.shortref</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">data.site</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>.groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="interactive-map-view">Interactive map view<a class="anchor" aria-label="anchor" href="#interactive-map-view"></a>
</h3>
<p>The resulting <code>sf</code> object can be plotted interactively with the <a href="https://CRAN.R-project.org/package=mapview" class="external-link">mapview</a> package.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Moga_spatial %&gt;% mapview::mapview()</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="static-map-plot">Static map plot<a class="anchor" aria-label="anchor" href="#static-map-plot"></a>
</h3>
<p>The <code>sf</code> object can also be used for a static plot – which is useful for publications. We download some simple country border base map vector data with the <a href="https://CRAN.R-project.org/package=rnaturalearth" class="external-link">rnaturalearth</a> R package and transform it to <code>sf</code> as well.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">countries</span> <span class="op">&lt;-</span> <span class="fu">rnaturalearth</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html" class="external-link">ne_countries</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Now we can combine the base layer and our point data to create the prototype of a static map plot.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># geom_sf is a special geom to handle spatial data in the sf format</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">countries</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># the explicit mapping of variables is not necessary here, as geom_sf </span></span>
<span>  <span class="co"># automatically finds the *geom* column in the input table</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">countries</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">formal_en</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Moga_spatial</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># with geom_sf comes coord_sf to manage the underlying coordinate grid</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">30</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="simple_plotting_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p>Please feel free to open an issue <a href="https://github.com/ropensci/c14bazAAR/issues" class="external-link">here</a> if you have questions about plotting radiocarbon dates.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
